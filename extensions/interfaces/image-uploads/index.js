import{defineInterface as n}from"@directus/extensions-sdk";import{defineComponent as e,ref as r,resolveComponent as t,openBlock as o,createElementBlock as a,normalizeClass as i,createElementVNode as l,toDisplayString as d,Fragment as u,createVNode as s,createCommentVNode as c,pushScopeId as p,popScopeId as v}from"vue";import{useI18n as f}from"vue-i18n";function b(n,e,r,t){return new(r||(r=Promise))((function(o,a){function i(n){try{d(t.next(n))}catch(n){a(n)}}function l(n){try{d(t.throw(n))}catch(n){a(n)}}function d(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(i,l)}d((t=t.apply(n,e||[])).next())}))}function g(n,e){var r,t,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(d){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(r=1,t&&(o=2&l[0]?t.return:l[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,l[1])).done)return o;switch(t=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,t=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=e.call(n,i)}catch(n){l=[6,n],t=0}finally{r=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,d])}}}var h,m,y,w={exports:{}};h=w,m=w.exports,y=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==y)return y;throw new Error("unable to locate global object")}(),h.exports=m=y.fetch,y.fetch&&(m.default=y.fetch.bind(y)),m.Headers=y.Headers,m.Request=y.Request,m.Response=y.Response;var x=w.exports,k=e({props:{value:{type:String,default:null}},emits:["input"],setup:function(n,e){var t=e.emit;var o=f().t,a=function(){var n=r(!1),e=r(!1);return{uploading:n,invalid:e,onBrowseSelect:function(r){var t,o=null===(t=r.target)||void 0===t?void 0:t.files;o&&function(r){b(this,void 0,void 0,(function(){var t,o,a,i;return g(this,(function(d){switch(d.label){case 0:return n.value=!0,e.value=!1,(t=r[0]).size>1e6?(e.value=!0,n.value=!1,[3,6]):[3,1];case 1:return d.trys.push([1,4,5,6]),(o=new FormData).append("file",t),a={method:"post",body:o},[4,x(window.location.origin+"/s3/upload-photo",a).then((function(n){return n.json()})).then((function(n){return console.log("Result upload-images API:",n),console.log("result.data.url:",n.data.url),n.data.url})).catch((function(n){throw new Error(n)}))];case 2:return l(d.sent()),[4,(u=1e3,new Promise((function(n){return setTimeout(n,u)})))];case 3:return d.sent(),[3,6];case 4:throw i=d.sent(),new Error(i);case 5:return n.value=!1,[7];case 6:return[2]}var u}))}))}(o)}}}(),i=a.invalid;return{t:o,uploading:a.uploading,invalid:i,onBrowseSelect:a.onBrowseSelect,handleChange:l};function l(n){t("input",n)}}});const S=n=>(p("data-v-479b8c6e"),n=n(),v(),n),T={class:"v-input"},B={class:"input disabled"},E=["value"],_={key:0,class:"type-text"},j={class:"actions"},R=S((()=>l("p",{class:"type-label"},"Select image to upload",-1))),A={key:0,class:"validation-error"};var C=[],I=[];!function(n,e){if(n&&"undefined"!=typeof document){var r,t=!0===e.prepend?"prepend":"append",o=!0===e.singleTag,a="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(o){var i=C.indexOf(a);-1===i&&(i=C.push(a)-1,I[i]={}),r=I[i]&&I[i][t]?I[i][t]:I[i][t]=l()}else r=l();65279===n.charCodeAt(0)&&(n=n.substring(1)),r.styleSheet?r.styleSheet.cssText+=n:r.appendChild(document.createTextNode(n))}function l(){var n=document.createElement("style");if(n.setAttribute("type","text/css"),e.attributes)for(var r=Object.keys(e.attributes),o=0;o<r.length;o++)n.setAttribute(r[o],e.attributes[r[o]]);var i="prepend"===t?"afterbegin":"beforeend";return a.insertAdjacentElement(i,n),n}}(".validation-error[data-v-479b8c6e] {\n  display: block;\n  margin-top: 4px;\n  color: var(--danger);\n  font-style: italic;\n}\n.invalid[data-v-479b8c6e] {\n  margin: -12px;\n  padding: 12px;\n  background-color: var(--danger-alt);\n  border-radius: var(--border-radius);\n  transition: var(--medium) var(--transition);\n  transition-property: background-color, padding, margin;\n}\n.v-upload[data-v-479b8c6e] {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  padding: 10px;\n  color: var(--foreground-subdued);\n  text-align: center;\n  border: 2px dashed var(--border-normal);\n  border-radius: var(--border-radius);\n  transition: var(--fast) var(--transition);\n  transition-property: color, border-color, background-color;\n}\n.v-upload p[data-v-479b8c6e] {\n  color: inherit;\n}\n.v-upload[data-v-479b8c6e]:not(.uploading):hover {\n  border-color: var(--primary);\n  color: var(--primary);\n}\n.actions[data-v-479b8c6e] {\n  display: flex;\n  justify-content: center;\n}\n.actions .v-button[data-v-479b8c6e] {\n  margin-right: 12px;\n}\n.actions .v-button[data-v-479b8c6e]:last-child {\n  margin-right: 0;\n}\n.browse[data-v-479b8c6e] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: block;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  opacity: 0;\n  appearance: none;\n}\n.uploading[data-v-479b8c6e] {\n  color: var(--white);\n  background-color: var(--primary);\n  border-color: var(--primary);\n  border-style: solid;\n}\nbody {\n  --v-input-font-family: var(--family-sans-serif);\n  --v-input-placeholder-color: var(--foreground-subdued);\n  --v-input-box-shadow-color-focus: var(--primary);\n  --v-input-color: var(--foreground-normal);\n  --v-input-background-color: var(--background-input);\n  --v-input-border-color-focus: var(--primary);\n}\n.v-input[data-v-479b8c6e] {\n  display: flex;\n  align-items: center;\n  height: var(--input-height);\n  margin-bottom: 10px;\n}\n.v-input .prepend-outer[data-v-479b8c6e] {\n  margin-right: 8px;\n}\n.v-input .input[data-v-479b8c6e] {\n  position: relative;\n  display: flex;\n  flex-grow: 1;\n  align-items: center;\n  height: 100%;\n  padding: var(--input-padding);\n  padding-top: 0px;\n  padding-bottom: 0px;\n  color: var(--v-input-color);\n  font-family: var(--v-input-font-family);\n  background-color: var(--v-input-background-color);\n  border: var(--border-width) solid var(--border-normal);\n  border-radius: var(--border-radius);\n  transition: border-color var(--fast) var(--transition);\n}\n.v-input .input.disabled[data-v-479b8c6e] {\n  --arrow-color: var(--border-normal);\n  color: var(--foreground-subdued);\n  background-color: var(--background-subdued);\n  border-color: var(--border-normal);\n}\n.v-input input[data-v-479b8c6e] {\n  flex-grow: 1;\n  height: 100%;\n  padding: var(--input-padding);\n  padding-right: 0px;\n  padding-left: 0px;\n  font-family: var(--v-input-font-family);\n  background-color: transparent;\n  border: none;\n  appearance: none;\n  text-overflow: ellipsis;\n}",{}),k.render=function(n,e,r,p,v,f){const b=t("v-icon");return o(),a("div",{class:i({invalid:n.invalid})},[l("div",T,[l("div",B,[l("input",{value:n.value,disabled:"",id:"Name",type:"input",onInput:e[0]||(e[0]=e=>n.handleChange(e)),placeholder:"Uploading successfully, the photo URL is show here!"},null,40,E)])]),l("div",{"data-dropzone":"",class:i(["v-upload",{uploading:n.uploading}])},[n.uploading?(o(),a("p",_,d(n.t("upload_file_indeterminate")),1)):(o(),a(u,{key:1},[l("div",j,[l("input",{ref:"file",class:"browse",type:"file",onInput:e[1]||(e[1]=(...e)=>n.onBrowseSelect&&n.onBrowseSelect(...e)),accept:"image/*"},null,544),s(b,{name:"file_upload"})]),R],64))],2),n.invalid?(o(),a("small",A," This file is too large to be uploaded. Files larger than 1MB are not currently supported ")):c("v-if",!0)],2)},k.__scopeId="data-v-479b8c6e",k.__file="src/interfaces/image-uploads/interface.vue";var q=n({id:"image-uploads",name:"Custom Image Upload",icon:"box",description:"This is image uploads custom interface!",component:k,options:null,types:["string"]});export{q as default};
